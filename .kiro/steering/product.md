# プロダクト設計原則

## プロダクトビジョン

**家庭菜園管理アプリケーション（マイガーデン）** は、家庭菜園利用者が作物の栽培を効率的に記録・管理し、データに基づいた栽培改善を実現するためのプラットフォームです。

### コアバリュー

1. **栽培の見える化**: 作物のライフサイクル全体を記録し、成長過程を可視化
2. **作業の効率化**: 水やり・施肥などの定期タスクを自動化し、最適なタイミングで通知
3. **データに基づく改善**: 栽培履歴を分析し、収穫量向上のための知見を提供
4. **モバイル専用アプリ**: iOS/Androidで現場での記録・管理に特化

## ターゲットユーザー

- **プライマリ**: 家庭菜園利用者（ベランダ、庭、市民農園等）
- **ユースケース**:
  - 複数の作物を同時栽培している
  - 水やり・施肥のタイミングを忘れがち
  - 過去の栽培記録を振り返りたい
  - 区画ごとに異なる作物を管理したい

## コア機能スコープ

### Phase 1（本仕様の対象範囲）

1. **作物ライフサイクル管理**
   - 種まき〜収穫までの全記録
   - 成長ステージごとの状態管理
   - 写真付きタイムライン

2. **区画管理**
   - 複数区画の登録と可視化
   - 区画ごとの作物割り当て
   - 区画の稼働状況追跡

3. **作業タスク管理**
   - 水やり・施肥等の定期タスク自動生成
   - カレンダー表示とリマインダー通知
   - 作業完了記録

4. **栽培データ分析**
   - 作物別の収穫量統計
   - 成長速度の可視化
   - 過去栽培との比較

5. **通知機能**
   - 定期タスクのリマインダー（Email/Push）
   - 成長ステージ変更の通知
   - 収穫予定日の事前通知

### 明示的に対象外（Out of Scope）

以下の機能は本Phase 1の範囲外です：

1. **AI画像認識**: 病害虫の自動識別、作物の種類判定
2. **SNS機能**: ユーザー間のフォロー、コメント、いいね
3. **IoT統合**: センサー連携、自動水やりシステム連携
4. **マーケットプレイス**: 収穫物の売買、種苗の購入
5. **コミュニティ機能**: フォーラム、Q&A、ナレッジベース
6. **リアルタイム協業**: 複数ユーザーによる同時編集、チャット
7. **オフライン同期**: ネットワーク不通時の完全なオフライン動作

## プロダクト制約

### 技術的制約

- **データ整合性優先**: 栽培データの損失は許容されない
- **レスポンス要件**: API応答時間 < 500ms (P95)、UI操作は200ms以内にフィードバック
- **可用性目標**: 99.5%以上（月間ダウンタイム < 3.6時間）
- **セキュリティ**: JWT認証、HTTPS必須、個人データ保護

### ビジネス制約

- **初期ターゲット**: 日本語圏ユーザー（国際化は将来フェーズ）
- **無料プラン**: 基本機能は無料提供（区画数・作物数に制限あり）
- **データ保持期間**: 削除操作後90日間は論理削除（復元可能）

### UX原則

- **モバイルファースト**: 外出先での作業記録を最優先
- **3タップ以内**: 主要な操作（タスク完了、写真記録）は3タップ以内で完了
- **ダークモード対応**: 夜間・屋外での視認性確保
- **オフライン表示**: ネットワーク不通時も過去データは閲覧可能（読み取り専用）

## 成功指標（KPI）

- **エンゲージメント**: 週次アクティブユーザー率 > 60%
- **データ品質**: 平均記録頻度 > 週2回/ユーザー
- **タスク完了率**: リマインダー通知後24時間以内の完了率 > 70%
- **継続率**: 初回利用から30日後のリテンション > 40%

## UI/UXデザイン哲学

### デザインシステム参照

プロジェクト内の `design/stitch_*/code.html` ファイル群が、実装すべきUIデザインの標準となります。

### デザイン原則

1. **視覚的な階層構造**
   - Featured Card: 緊急度の高い「次の作業」を目立たせる
   - Status Indication: 色とアイコンで状態を直感的に伝える（green=健康、yellow=注意、red=緊急）

2. **一貫性のあるインタラクション**
   - Bottom Navigation: 4つの主要画面への高速アクセス
   - FAB (Floating Action Button): 主要アクション（新規作物追加、写真記録）
   - Sticky Header: スクロール時もコンテキストを保持

3. **情報の段階的開示**
   - Overview → Detail: ダッシュボードで概要、詳細画面で完全情報
   - Tab Navigation: 関連情報を論理的にグループ化（概要、ログ、写真）

4. **アクセシビリティ**
   - WCAG 2.1 Level AA準拠
   - タッチターゲット最小サイズ: 44x44px
   - 色以外での情報伝達（アイコン併用）

## データ設計哲学

### データモデル原則

1. **論理削除パターン**: すべてのエンティティは `deleted_at` カラムを持ち、物理削除を行わない
2. **JSONB活用**: 将来的な拡張性のため、柔軟なフィールドは JSONB 型で保存（例: `additional_info`）
3. **タイムスタンプ必須**: すべてのエンティティは `created_at`, `updated_at` を持つ
4. **外部キー制約**: データ整合性を DB レベルで保証

### ドメイン境界

以下の6つのドメインで構成：

1. **User**: ユーザー認証・プロフィール管理
2. **Crop**: 作物の栽培記録・ライフサイクル管理
3. **Plot**: 区画管理・空間配置
4. **Task**: 作業タスク・リマインダー管理
5. **Analytics**: データ分析・統計計算
6. **Notification**: 通知配信・履歴管理

各ドメインは独立したサービス・リポジトリ層を持ち、疎結合を保つ。
