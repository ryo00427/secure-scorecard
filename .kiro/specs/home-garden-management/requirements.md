# Requirements Document

## Project Description (Input)

家庭菜園を管理するアプリ（モノレポ方式）

## Introduction

本アプリケーションは、家庭菜園での作物栽培を効率的に管理するためのモバイルアプリケーション（iOS/Android）です。モノレポ方式を採用し、モバイルフロントエンド（React Native/Expo）、バックエンド（Go/Echo）、共有ライブラリ（TypeScript）を統合的に管理します。ユーザーは作物の植え付けから収穫までのライフサイクルを記録し、栽培タスクを管理し、栽培データを分析できます。

## Requirements

### 要件 1: 作物管理

**Objective:** 家庭菜園利用者として、作物の植え付けから収穫までのライフサイクルを記録したい。これにより、栽培履歴を把握し、次回の栽培計画に活用できる。

#### Acceptance Criteria

1. When ユーザーが作物を新規登録する, the システム shall 作物名、品種、植え付け日、予想収穫日を記録する
2. When ユーザーが作物の成長記録を追加する, the システム shall 記録日、成長段階、観察メモ、写真（オプション）を保存する
3. When ユーザーが収穫を記録する, the システム shall 収穫日、収穫量、品質評価を記録し、作物のステータスを「収穫済み」に更新する
4. The システム shall 作物ごとに成長履歴を時系列で表示する
5. If 予想収穫日の 7 日前になった, then the システム shall ユーザーに収穫準備の通知を送信する

### 要件 2: 菜園区画管理

**Objective:** 家庭菜園利用者として、菜園の区画を管理し、どの区画に何を植えているか視覚的に把握したい。これにより、輪作計画や空き区画の確認が容易になる。

#### Acceptance Criteria

1. When ユーザーが新しい区画を登録する, the システム shall 区画名、サイズ（縦 × 横）、土壌タイプ、日当たり条件を記録する
2. When ユーザーが区画に作物を配置する, the システム shall 区画と作物の紐付けを保存し、区画の使用状況を「使用中」に更新する
3. The システム shall 菜園全体のレイアウトをグリッド表示で可視化する
4. The システム shall 各区画の使用履歴（過去に栽培した作物）を表示する
5. While 区画が使用中である, the システム shall 同じ区画への重複配置を防止する

### 要件 3: タスク管理

**Objective:** 家庭菜園利用者として、水やり、施肥、除草などの栽培タスクを計画・管理したい。これにより、定期的なメンテナンス作業を忘れずに実行できる。

#### Acceptance Criteria

1. When ユーザーがタスクを作成する, the システム shall タスク名、作物/区画、予定日、繰り返し設定（オプション）、優先度を記録する
2. When タスクの予定日が当日になる, the システム shall タスクを「今日のタスク」リストに表示する
3. When ユーザーがタスクを完了としてマークする, the システム shall 完了日時を記録し、タスクのステータスを「完了」に更新する
4. The システム shall 未完了タスクを優先度と予定日でソートして表示する
5. If タスクが予定日を過ぎても未完了である, then the システム shall タスクを「期限切れ」としてハイライト表示する
6. Where 繰り返し設定が有効である, the システム shall タスク完了時に次回のタスクを自動生成する

### 要件 4: 記録・分析

**Objective:** 家庭菜園利用者として、栽培データを分析し、成功パターンや改善点を把握したい。これにより、栽培技術を向上させることができる。

#### Acceptance Criteria

1. The システム shall 作物ごとの総収穫量、平均成長期間を集計して表示する
2. The システム shall 月別・作物別の収穫量をグラフで可視化する
3. When ユーザーが特定の作物を選択する, the システム shall その作物の過去の栽培記録（成長段階、問題点、収穫結果）を一覧表示する
4. The システム shall 区画ごとの栽培履歴と生産性（収穫量/面積）を表示する
5. The システム shall 栽培データを CSV 形式でエクスポートできる

### 要件 5: 通知機能

**Objective:** 家庭菜園利用者として、重要なタスクやイベントをタイムリーに通知されたい。これにより、作業の遅れや見落としを防止できる。

#### Acceptance Criteria

1. When 当日に予定されたタスクがある, the システム shall ユーザーにプッシュ通知またはメール通知を送信する
2. When 収穫予定日の 7 日前になる, the システム shall ユーザーに収穫準備の通知を送信する
3. When 新しい成長記録が追加される, the システム shall 関連する作物のステータスを更新し、必要に応じて通知を送信する
4. The システム shall ユーザーが通知設定（通知方法、通知タイミング）をカスタマイズできる
5. If 期限切れタスクが 3 つ以上ある, then the システム shall ユーザーに注意喚起の通知を送信する

### 要件 6: ユーザー管理

**Objective:** 家庭菜園利用者として、自分のアカウントで安全にログインし、個人の菜園データを管理したい。これにより、複数ユーザーが独立してアプリを利用できる。

#### Acceptance Criteria

1. When ユーザーが新規登録する, the システム shall メールアドレス、パスワード、ユーザー名を記録し、認証トークンを発行する
2. When ユーザーがログインする, the システム shall 認証情報を検証し、有効なセッションを確立する
3. The システム shall ユーザーごとに菜園データ（作物、区画、タスク）を分離して管理する
4. The システム shall パスワードをハッシュ化して保存する
5. When ユーザーがログアウトする, the システム shall セッションを無効化し、認証トークンを削除する
6. If ログイン試行が 3 回連続で失敗した, then the システム shall アカウントを一時的にロックし、ユーザーにメール通知を送信する

### 要件 7: モノレポ構成

**Objective:** 開発チームとして、フロントエンド、バックエンド、共有ライブラリを統合的に管理し、開発効率を向上させたい。

#### Acceptance Criteria

1. The システム shall モノレポ構造（frontend/, backend/, shared/）でコードを管理する
2. The システム shall 共有ライブラリ（TypeScript 型定義、共通ユーティリティ）を frontend と backend で再利用する
3. The システム shall 各パッケージの依存関係をワークスペース機能で管理する
4. The システム shall CI/CD パイプラインで全パッケージのビルド・テストを自動実行する
5. The システム shall コードリンター・フォーマッター（ESLint, Prettier）をモノレポ全体で統一的に適用する
